# Fit Assessment

Collecting guest level information from multiple VMs may be automated by shell scripting the use of mfit CLI tool. The collection of guest level information can be achieved by leveraging SSH for Linux VMs and VMWare tools for Linux and Windows VMs. The collection for each VM includes:
* Uploading the collection script to the VM
* Running the script on the VM
* Downloading and importing the results

The below sample scripts can be used as a reference to get started with collection at scale and it can be enhanced and modified to satisfy your requirements. Below is a brief explanation on each of the scripts:

1. [mfit_discovery_export.sh](./mfit_discovery_export.sh) - This scripts creates a CSV file with the following fields `NAME;PLATFORM VM ID;COLLECTED DATA;OS;IP;USERNAME;PASSWORD`. Note that USERNAME and PASSWORD will always be empty and can be modified manually to set a unique USERNAME and PASSWORD for guest collection using one of the below scripts. See a sample CSV at [sample_vms.csv](./sample_vms.csv)
2. [mfit_collect_vms_ssh_password.sh](./mfit_collect_vms_ssh_password.sh) - This script prompts the user for a CSV_FILE(in the format above),USERNAME and PASSWORD and will iterate over all VMs in the CSV file to run the collection script on each Linux VM via SSH using username/password authentication. If a VM has different credentials it can be set in the CSV file per VM.
3. [mfit_collect_vms_ssh_key.sh](./mfit_collect_vms_ssh_key.sh) - This script prompts the user for a CSV_FILE and a USERNAME and it will run collection on all the Linux VMs in the CSV file authenticating with SSH key. You **must** set the environment variable MFIT_SSH_IDENTITY_FILE to the SSH identity file and if needed the MFIT_SSH_PASSPHRASE to the key passphrase.
4. [mfit_collect_vms_guest_tools.sh](./mfit_collect_vms_guest_tools.sh) - This script prompts the user for a CSV_FILE(in the format above), VSPHERE_URL, VSPHERE_USER, VSPHERE_PASSWORD, USERNAME and PASSWORD and will iterate over all VMs in the CSV file to run the collection script on each VM(both Linux and Windows) via VMWare tools using username/password authentication. If a VM has different credentials it can be set in the CSV file per VM.
5. [mfit_collect_vms_guest_tools_govc.sh](./mfit_collect_vms_guest_tools_govc.sh) - This script works in a slightly different manner to all other scripts. It leverages the [govc](https://github.com/vmware/govmomi/tree/master/govc) vSphere CLI to retrieve all the VMs with VMWare tools installed. It then iterates through the matched VMs and uses VMWare tools to collect guest level information from the VMs. It prompts the user for VSPHERE_URL, VSPHERE_USER, VSPHERE_PASSWORD, USERNAME and PASSWORD. You must download and install the govc CLI on the mFit workstation by downloading the binaries for your platfrom [here](https://github.com/vmware/govmomi/releases)

To read more about mFit please look at the formal documentation [here](https://cloud.google.com/migrate/anthos/docs/fit-assessment)